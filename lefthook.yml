# Lefthook configuration for Mengshen Pinyin Font project
# https://github.com/evilmartians/lefthook

# 共通設定
colors: true
skip_output:
  - summary
  - execution_info

# Gitフック設定
pre-commit:
  commands:
    # Pythonコードフォーマット
    format-python:
      glob: "*.py"
      run: |
        # Import sorting with isort
        isort {staged_files}
        # Code formatting with black  
        black {staged_files}
      stage_fixed: true
      fail_text: "Pythonコードフォーマットが完了しました。変更を確認してコミットしてください。"

    # Pythonコード品質チェック
    python-syntax:
      glob: "*.py"
      run: python -m py_compile {staged_files}
      stage_fixed: true
      fail_text: "Python構文エラーが見つかりました。"

    # Pythonリンティング
    python-lint:
      glob: "*.py"
      run: flake8 {staged_files}
      fail_text: "Flake8リンティングエラーが見つかりました。修正してください。"

pre-push:
  commands:
    # コア機能テスト実行
    core-tests:
      run: python -m pytest tests/unit/ tests/security/ -x --tb=short
      fail_text: "コア機能テストが失敗しました。修正してからpushしてください。"
